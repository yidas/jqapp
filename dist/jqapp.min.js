/**
 * Jqapp
 * 
 * @author  Nick Tsai <myintaer@gmail.com>
 * @version 1.0.0
 * @see     https://github.com/yidas/jqapp
 */
!function(e,t){"use strict";var n=function(e,t){var n=this;if(e=e||{},this.options=Object.freeze(e),this.el=null,this.$el=null,this.template=!1,this.components=e.components||{},this.hooks={beforeCreate:e.beforeCreate||null,created:e.created||null,beforeMount:e.beforeMount||null,mounted:e.mounted||null,beforeDestroy:e.beforeDestroy||null,destroyed:e.destroyed||null},"function"==typeof this.hooks.beforeCreate&&this.hooks.beforeCreate.bind(this)(),e.data)for(var o in e.data)e.data.hasOwnProperty(o)&&(o in n?i.warn('Data "'+o+'" has already been defined as a reserved word.'):n[o]=e.data[o]);if(e.methods)for(var o in e.methods)e.data&&o in e.data?i.warn('Method "'+o+'" has already been defined as a data property.'):o in n?i.warn('Method "'+o+'" has already been defined as a reserved word.'):n[o]=e.methods[o];if("function"==typeof this.hooks.created&&this.hooks.created.bind(this)(),e.template){var r,s=document.createElement("div");if(0===e.template.indexOf("#"))(t=document.querySelector(e.template))||i.error("Component `"+id+"`: template not found"),r=t.innerHTML;else r=e.template;var a=new RegExp("{{\\s?(.*?)\\s?}}","gi");r=(r=r.replace(a,function(e,t,o,r){for(var i=n,s=t.split("."),a=0;a<s.length;a++){var h=s[a];if("object"!=typeof i||!(h in i))return"";i=i[h]}return String(i)})).replace(new RegExp("\\\\{","g"),"{"),s.innerHTML=r.trim(),1!==s.childElementCount&&i.error("template should contain exactly one root element."),this.template=s.firstChild}return this.mount(e.el),this};n.prototype.mount=function(e){return"function"==typeof this.hooks.beforeMount&&this.hooks.beforeMount.bind(this)(),!(!e&&!this.template)&&((n=!e&&this.template?this.template:i.queryElement(e))||i.error("element `"+e+"` not found",!0),e&&this.template&&(n=n.parentNode.replaceChild(this.template,n)),delete this.el,delete this.$el,this.el=n,this.$el=t?t(this.el):null,Object.defineProperty(this,"el",{configurable:!0,writable:!1}),Object.defineProperty(this,"$el",{configurable:!0,writable:!1}),"function"==typeof this.hooks.mounted&&this.hooks.mounted.bind(this)(),this);var n},n.prototype.remove=function(){return"function"==typeof this.hooks.beforeDestroy&&this.hooks.beforeDestroy.bind(this)(),this.el.parentNode&&(this.el.parentNode.removeChild(this.el),"function"==typeof this.hooks.destroyed&&this.hooks.destroyed.bind(this)()),this},n.prototype.find=function(e){return this.el.querySelector(e)},n.prototype.createComponent=function(e,n){return e||i.error("Component: First parameter `component key` required",!0),!e in this.components&&i.error("Component: `"+e+"` not found",!0),n=n?t?t.extend(!0,{},this.components[e],n):i.extend(!0,{},this.components[e],n):this.components[e],new r(n,e,this)},n.prototype.renderComponent=function(e,t){return this.createComponent(e,t).el},n.prototype.shorthand=function(e,t,n,o,r,s){var a=n?this.find(n):this.el;if(!a)return i.warn(e+"(): Query selector `"+n+"` not found",!0),!1;var h=this.renderComponent(o,r);return t.bind(this)(a,h),"function"==typeof s&&s.bind(this)(h),a},n.prototype.append=function(e,t,n,o){return this.shorthand("append",function(e,t){e.appendChild(t)},e,t,n,o)},n.prototype.replace=function(e,t,n,o){return this.shorthand("append",function(e,t){e.replaceChild(t,e)},e,t,n,o)},n.prototype.html=function(e,t,n,o){return this.shorthand("append",function(e,t){e.innerHTML="",e.appendChild(t)},e,t,n,o)},n.prototype.$find=function(e){return i.jQueryRequired(),this.$el.find(e)},n.prototype.$renderComponent=function(e,t){return i.jQueryRequired(),this.createComponent(e,t).$el},n.prototype.$shorthand=function(e,t,n,o,r,s){i.jQueryRequired();var a=this.$find(n),h=this.$renderComponent(o,r);return t.bind(this)(a,h),"function"==typeof s&&s.bind(this)(h),a},n.prototype.$append=function(e,t,n,o){return this.$shorthand("$append",function(e,t){e.append(t)},e,t,n,o)},n.prototype.$replace=function(e,t,n,o){return this.$shorthand("$replace",function(e,t){e.replaceWith(t)},e,t,n,o)},n.prototype.$html=function(e,t,n,o){return this.$shorthand("$html",function(e,t){e.html(t)},e,t,n,o)};var o=function(e){return o.config.jQuery&&!t&&i.error("jQuery is not loaded"),n.call(this,e),this};o.prototype=Object.create(n.prototype),o.config={jQuery:!0};var r=function(e,t,o){return e||i.error("Component `"+t+"`: invalid data"),e.template||i.error("Component `"+t+"`: template not defined"),this.id=t,this.parent=o,n.call(this,e),this};r.prototype=Object.create(n.prototype);var i=new function(){this.queryElement=function(e){return e instanceof HTMLElement?e:t&&e instanceof t?e.get(0):document.querySelector(e)},this.jQueryRequired=function(){return t||this.error("jQuery is required",6),!0},this.error=function(e,t){e="[Jqapp] "+e;throw e=t?e+"\nAt"+this.getErrorCaller(t):e},this.warn=function(e){console.error("[Jqapp Warn] "+e)},this.getErrorCaller=function(e){e=!isNaN(parseFloat(e))&&isFinite(e)?e:5;var t=function(){try{throw Error("")}catch(e){return e}}().stack.split("\n")[e];return t.slice(t.indexOf("at ")+2,t.length)},this.extend=function(){var e,t,n,o,r,i,s=arguments[0]||{},a=1,h=arguments.length,p=!1;if("boolean"==typeof s&&(p=s,s=arguments[a]||{},a++),"object"==typeof s||jQuery.isFunction(s)||(s={}),a===h)throw"Arguments required";for(;a<h;a++)if(null!=(e=arguments[a]))for(t in e)n=s[t],s!==(o=e[t])&&(p&&o&&("object"==typeof o||(r="[object Array]"===Object.prototype.toString.call(o)))?(r?(r=!1,i=n&&"[object Array]"===Object.prototype.toString.call(n)?n:[]):i=n&&"object"==typeof n?n:{},s[t]=this.extend(p,i,o)):void 0!==o&&(s[t]=o));return s}};e.Jqapp=o}(window,window.jQuery||null);